import {
  addCoordinateTransforms,
  addEquivalentProjections,
  addProjection,
  createSafeCoordinateTransform,
  get,
  get2
} from "./chunk-OIK747LX.js";
import {
  Projection_default
} from "./chunk-IB3752ZZ.js";
import "./chunk-3L7AZTGC.js";
import "./chunk-X7AUGEB2.js";
import "./chunk-F2MRU6YO.js";
import "./chunk-DFKQJ226.js";

// node_modules/ol/proj/proj4.js
var registered = null;
function isRegistered() {
  return !!registered;
}
function unregister() {
  registered = null;
}
function register(proj4) {
  registered = proj4;
  const projCodes = Object.keys(proj4.defs);
  const len = projCodes.length;
  let i, j;
  for (i = 0; i < len; ++i) {
    const code = projCodes[i];
    if (!get2(code)) {
      const def = proj4.defs(code);
      let units = (
        /** @type {import("./Units.js").Units} */
        def.units
      );
      if (!units && def.projName === "longlat") {
        units = "degrees";
      }
      addProjection(
        new Projection_default({
          code,
          axisOrientation: def.axis,
          metersPerUnit: def.to_meter,
          units
        })
      );
    }
  }
  for (i = 0; i < len; ++i) {
    const code1 = projCodes[i];
    const proj1 = get2(code1);
    for (j = 0; j < len; ++j) {
      const code2 = projCodes[j];
      const proj2 = get2(code2);
      if (!get(code1, code2)) {
        if (proj4.defs[code1] === proj4.defs[code2]) {
          addEquivalentProjections([proj1, proj2]);
        } else {
          const transform = proj4(code1, code2);
          addCoordinateTransforms(
            proj1,
            proj2,
            createSafeCoordinateTransform(proj1, proj2, transform.forward),
            createSafeCoordinateTransform(proj2, proj1, transform.inverse)
          );
        }
      }
    }
  }
}
var epsgLookup = async function(code) {
  const response = await fetch(`https://epsg.io/${code}.proj4`);
  if (!response.ok) {
    throw new Error(`Unexpected response from epsg.io: ${response.status}`);
  }
  return response.text();
};
function setEPSGLookup(func) {
  epsgLookup = func;
}
function getEPSGLookup() {
  return epsgLookup;
}
async function fromEPSGCode(code) {
  if (typeof code === "string") {
    code = parseInt(code.split(":").pop(), 10);
  }
  const proj4 = registered;
  if (!proj4) {
    throw new Error("Proj4 must be registered first with register(proj4)");
  }
  const epsgCode = "EPSG:" + code;
  if (proj4.defs(epsgCode)) {
    return get2(epsgCode);
  }
  proj4.defs(epsgCode, await epsgLookup(code));
  register(proj4);
  return get2(epsgCode);
}
export {
  fromEPSGCode,
  getEPSGLookup,
  isRegistered,
  register,
  setEPSGLookup,
  unregister
};
//# sourceMappingURL=ol_proj_proj4.js.map
